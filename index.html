<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jasper æ•¸å­¸æ¨¡æ“¬è©¦å· V9.1 (çœŸé¡Œå°é½Šç‰ˆ)</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Roboto+Mono:wght@500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f9ff; user-select: none; -webkit-tap-highlight-color: transparent; }
        .font-mono { font-family: 'Roboto Mono', monospace; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        
        .digit-input { width: 100%; height: 100%; text-align: center; font-family: 'Roboto Mono', monospace; font-weight: 700; font-size: 1.5rem; border: 2px solid #cbd5e1; border-radius: 0.5rem; background-color: white; color: #1e293b; transition: all 0.2s; }
        .digit-input:focus { border-color: #6366f1; outline: none; background-color: #eef2ff; transform: scale(1.05); z-index: 10; }
        .digit-input:disabled { background-color: #f8fafc; border-color: #e2e8f0; color: #94a3b8; }
        
        .carry-input { width: 100%; height: 30px; text-align: center; font-size: 0.9rem; font-weight: bold; color: #ef4444; background-color: transparent; border: 1px dashed #fda4af; border-radius: 4px; z-index: 5; margin-bottom: 2px; }
        .calc-line { height: 4px; background-color: #334155; border-radius: 2px; margin-top: 2px; margin-bottom: 4px; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        
        .op-select { appearance: none; text-align: center; cursor: pointer; outline: none; transition: all 0.2s; }
        .op-select:hover { transform: scale(1.05); }

        @keyframes slideDownFade { 0% { transform: translate(-50%, -100%); opacity: 0; } 15% { transform: translate(-50%, 0); opacity: 1; } 80% { transform: translate(-50%, 0); opacity: 1; } 100% { transform: translate(-50%, -100%); opacity: 0; } }
        .toast-anim { animation: slideDownFade 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const Icon = {
            Clock: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Check: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M20 6 9 17l-5-5"/></svg>,
            Brain: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></svg>,
            Idea: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.9 1.2 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>,
            FastForward: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polygon points="13 19 22 12 13 5 13 19"/><polygon points="2 19 11 12 2 5 2 19"/></svg>
        };

        const PRAISE_WORDS = ["å¤ªæ£’äº†ï¼", "Jasper å¥½é‡ï¼", "å®Œå…¨æ­£ç¢ºï¼", "åšå¾—å¥½ï¼", "æ•¸å­¸å¤©æ‰ï¼", "æ€è·¯æ¸…æ™°ï¼"];

        // --- è¦–è¦ºçµ„ä»¶ ---
        const BeakerView = ({ capacity = 1000, level, label }) => {
            const perc = level / capacity;
            return (
                <div className="flex flex-col items-center mx-2 my-2">
                    <svg width="100" height="130" viewBox="0 0 140 180" className="drop-shadow-md">
                        <path d="M30 20 L30 160 A10 10 0 0 0 40 170 L110 170 A10 10 0 0 0 120 160 L120 20" fill="white" stroke="#334155" strokeWidth="6"/>
                        {perc > 0 && <rect x="33" y={167 - (147 * perc)} width="84" height={147 * perc} fill="#60a5fa" opacity="0.8" rx="2" />}
                        {perc > 0 && <line x1="33" y1={167 - (147 * perc)} x2="117" y2={167 - (147 * perc)} stroke="#2563eb" strokeWidth="3" />}
                        <line x1="100" y1="130.25" x2="120" y2="130.25" stroke="#1e293b" strokeWidth="3"/>
                        <text x="95" y="134" fontSize="16" fontWeight="bold" textAnchor="end" fill="#475569">{capacity * 0.25}</text>
                        <line x1="100" y1="93.5" x2="120" y2="93.5" stroke="#1e293b" strokeWidth="3"/>
                        <text x="95" y="97" fontSize="16" fontWeight="bold" textAnchor="end" fill="#475569">{capacity * 0.5}</text>
                        <line x1="100" y1="56.75" x2="120" y2="56.75" stroke="#1e293b" strokeWidth="3"/>
                        <text x="95" y="60" fontSize="16" fontWeight="bold" textAnchor="end" fill="#475569">{capacity * 0.75}</text>
                        <line x1="100" y1="20" x2="120" y2="20" stroke="#1e293b" strokeWidth="3"/>
                    </svg>
                    <div className="mt-2 font-bold text-slate-700 bg-white px-2 py-1 rounded shadow-sm text-sm">{label} (å®¹ç©:{capacity}mL)</div>
                </div>
            );
        };

        const AbacusView = ({ number }) => {
            const digits = number.toString().padStart(5, '0').split('');
            const places = ['è¬', 'åƒ', 'ç™¾', 'å', 'å€‹'];
            return (
                <div className="flex justify-center gap-3 my-6 bg-amber-50 p-6 rounded-2xl border-2 border-amber-200 shadow-sm">
                    {digits.map((d, i) => (
                        <div key={i} className="flex flex-col items-center">
                            <div className="h-32 w-1 bg-slate-400 relative mb-2">
                                {[...Array(parseInt(d))].map((_, j) => (
                                    <div key={j} className="absolute w-8 h-5 bg-amber-600 rounded-full left-1/2 transform -translate-x-1/2 border border-amber-800 shadow-sm z-10" style={{bottom: j * 20}}></div>
                                ))}
                            </div>
                            <div className="w-10 h-10 flex items-center justify-center border-2 border-slate-600 bg-white font-bold text-slate-700 rounded-lg shadow-sm text-lg">{places[i]}</div>
                        </div>
                    ))}
                </div>
            );
        };

        const PictogramView = ({ data, title }) => {
            return (
                <div className="my-6 w-full max-w-md mx-auto bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                    <div className="text-center font-bold text-xl mb-6 border-b-2 border-slate-100 pb-2">{title || "ï¼ˆæ¨™é¡Œï¼‰"}</div>
                    <div className="flex justify-end mb-4 pr-4">
                        <div className="flex items-center gap-2 bg-slate-100 px-3 py-1 rounded-full text-xs font-bold text-slate-600">
                            <div className="w-4 h-4 rounded-full bg-blue-500"></div> = 1 äºº
                        </div>
                    </div>
                    <div className="flex justify-around items-end h-56 border-b-2 border-slate-800 pb-2 px-2">
                        {data.map((item, i) => (
                            <div key={i} className="flex flex-col items-center gap-2 w-1/5">
                                <div className="flex flex-col-reverse gap-1 h-full justify-start">
                                    {[...Array(item.value)].map((_, j) => (
                                        <div key={j} className="w-6 h-6 rounded-full bg-blue-500 border-2 border-white shadow-sm ring-1 ring-blue-200"></div>
                                    ))}
                                </div>
                                <div className="mt-2 text-sm font-bold text-slate-700 writing-mode-vertical text-center">{item.name}</div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        // --- ç›´å¼çµ„ä»¶ ---
        const VerticalAddSub = ({ n1, n2, op, onComplete }) => {
            const digits1 = n1.toString().padStart(4, ' ').split('');
            const digits2 = n2.toString().padStart(4, ' ').split('');
            const [inputs, setInputs] = useState(['', '', '', '']);
            const [carries, setCarries] = useState(['', '', '', '']);
            const [userOp, setUserOp] = useState('?');
            const [errorMsg, setErrorMsg] = useState('');
            const correctAns = op === '+' ? n1 + n2 : n1 - n2;
            const correctDigits = correctAns.toString().padStart(4, ' ').split('');

            const checkAnswer = () => {
                if (userOp !== op) { setErrorMsg(`è«‹é¸æ“‡æ­£ç¢ºçš„è¨ˆç®—ç¬¦è™Ÿï¼(æ‡‰è©²æ˜¯ ${op} å–”)`); return; }
                let userNumStr = inputs.map(d => d === '' ? ' ' : d).join('');
                if (parseInt(userNumStr.replace(/\s/g, '')) === correctAns) onComplete(correctAns);
                else setErrorMsg('å°å¿ƒï¼æª¢æŸ¥ä½ çš„ç­”æ¡ˆå’Œç®—è‰ã€‚');
            };

            return (
                <div className="bg-white p-6 rounded-2xl border-2 border-slate-200 shadow-sm max-w-sm mx-auto animate-in zoom-in-95">
                    <div className="grid grid-cols-5 gap-1 font-mono">
                        <div className="col-span-1"></div>{digits1.map((d, i) => <div key={`d1-${i}`} className="h-10 flex items-center justify-center text-3xl font-black text-slate-700">{d}</div>)}
                        <select value={userOp} onChange={e=>{setUserOp(e.target.value); setErrorMsg('');}} className="op-select col-span-1 text-3xl font-black text-blue-600 bg-blue-50 border-2 border-blue-200 rounded-lg">
                            <option value="?">?</option><option value="+">+</option><option value="-">-</option><option value="Ã—">Ã—</option>
                        </select>
                        {digits2.map((d, i) => <div key={`d2-${i}`} className="h-10 flex items-center justify-center text-3xl font-black text-slate-700">{d}</div>)}
                        <div className="col-span-1"></div>{carries.map((v, i) => (<div key={`c-${i}`} className="flex items-end justify-center"><input className="carry-input" value={v} placeholder="." onChange={e=>setCarries(p=>{const n=[...p];n[i]=e.target.value.slice(-2);return n;})} /></div>))}
                        <div className="col-span-5 calc-line"></div>
                        <div className="col-span-1"></div>{inputs.map((v, i) => (<input key={`in-${i}`} type="number" className={`digit-input h-14 ${v!=='' && correctDigits[i]!==' ' && v!==correctDigits[i] ? 'bg-red-50 border-red-300 text-red-600' : ''}`} value={v} disabled={correctDigits[i]===' '} onChange={e => {setInputs(p=>{const n=[...p];n[i]=e.target.value.slice(-1);return n;}); setErrorMsg('');}} />))}
                    </div>
                    {errorMsg && <div className="mt-3 text-center text-rose-500 font-bold text-sm bg-rose-50 p-2 rounded">{errorMsg}</div>}
                    <button onClick={checkAnswer} className="mt-5 w-full bg-indigo-600 text-white py-3 rounded-xl font-black shadow-md active:scale-95 transition-all hover:bg-indigo-700">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            );
        };

        const VerticalContinuous = ({ n1, n2, n3, op1, op2, onComplete }) => {
            const digits1 = n1.toString().padStart(4, ' ').split('');
            const digits2 = n2.toString().padStart(4, ' ').split('');
            const digits3 = n3.toString().padStart(4, ' ').split('');
            const step1Ans = op1 === '+' ? n1 + n2 : n1 - n2;
            const digitsStep1 = step1Ans.toString().padStart(4, ' ').split('');
            const finalAns = op2 === '+' ? step1Ans + n3 : step1Ans - n3;
            const digitsFinal = finalAns.toString().padStart(4, ' ').split('');

            const [inputs1, setInputs1] = useState(['', '', '', '']); const [carries1, setCarries1] = useState(['', '', '', '']);
            const [inputs2, setInputs2] = useState(['', '', '', '']); const [carries2, setCarries2] = useState(['', '', '', '']);
            const [userOp1, setUserOp1] = useState('?'); const [userOp2, setUserOp2] = useState('?');
            const [errorMsg, setErrorMsg] = useState('');

            const checkAnswer = () => {
                if (userOp1 !== op1) { setErrorMsg('ç¬¬ä¸€å€‹è¨ˆç®—ç¬¦è™Ÿé¸éŒ¯äº†ï¼'); return; }
                if (userOp2 !== op2) { setErrorMsg('ç¬¬äºŒå€‹è¨ˆç®—ç¬¦è™Ÿé¸éŒ¯äº†ï¼'); return; }
                let u1 = parseInt(inputs1.map(d => d===''?' ':d).join('').replace(/\s/g, ''));
                let u2 = parseInt(inputs2.map(d => d===''?' ':d).join('').replace(/\s/g, ''));
                if (u1 !== step1Ans) { setErrorMsg('ç¬¬ä¸€æ­¥ç®—éŒ¯äº† (ä¸­é–“é‚£è¡Œ)'); return; }
                if (u2 !== finalAns) { setErrorMsg('æœ€å¾Œç­”æ¡ˆç®—éŒ¯äº†'); return; }
                onComplete(finalAns);
            };

            return (
                <div className="bg-white p-6 rounded-2xl border-2 border-slate-200 shadow-sm max-w-sm mx-auto animate-in zoom-in-95">
                    <div className="grid grid-cols-5 gap-1 font-mono items-center">
                        <div className="col-span-1"></div>{digits1.map((d, i) => <div key={`d1-${i}`} className="h-8 flex items-center justify-center text-2xl font-black text-slate-700">{d}</div>)}
                        
                        <select value={userOp1} onChange={e=>{setUserOp1(e.target.value); setErrorMsg('');}} className="op-select col-span-1 text-2xl font-black text-blue-600 bg-blue-50 border-2 border-blue-200 rounded-lg">
                            <option value="?">?</option><option value="+">+</option><option value="-">-</option>
                        </select>
                        {digits2.map((d, i) => <div key={`d2-${i}`} className="h-8 flex items-center justify-center text-2xl font-black text-slate-700">{d}</div>)}
                        
                        <div className="col-span-1"></div>{carries1.map((v, i) => <div key={`c1-${i}`} className="flex items-end justify-center"><input className="carry-input" value={v} placeholder="." onChange={e=>setCarries1(p=>{const n=[...p];n[i]=e.target.value.slice(-2);return n;})} /></div>)}
                        <div className="col-span-5 calc-line"></div>
                        <div className="col-span-1"></div>{inputs1.map((v, i) => <input key={`in1-${i}`} type="number" className={`digit-input h-10 ${v!=='' && digitsStep1[i]!==' ' && v!==digitsStep1[i] ? 'bg-red-50 border-red-300' : ''}`} value={v} disabled={digitsStep1[i]===' '} onChange={e => {setInputs1(p=>{const n=[...p];n[i]=e.target.value.slice(-1);return n;}); setErrorMsg('');}} />)}
                        
                        <select value={userOp2} onChange={e=>{setUserOp2(e.target.value); setErrorMsg('');}} className="op-select col-span-1 text-2xl font-black text-blue-600 bg-blue-50 border-2 border-blue-200 rounded-lg mt-2">
                            <option value="?">?</option><option value="+">+</option><option value="-">-</option>
                        </select>
                        {digits3.map((d, i) => <div key={`d3-${i}`} className="h-8 flex items-center justify-center text-2xl font-black text-slate-700 mt-2">{d}</div>)}
                        
                        <div className="col-span-1"></div>{carries2.map((v, i) => <div key={`c2-${i}`} className="flex items-end justify-center mt-1"><input className="carry-input" value={v} placeholder="." onChange={e=>setCarries2(p=>{const n=[...p];n[i]=e.target.value.slice(-2);return n;})} /></div>)}
                        <div className="col-span-5 calc-line"></div>
                        <div className="col-span-1"></div>{inputs2.map((v, i) => <input key={`in2-${i}`} type="number" className={`digit-input h-10 ${v!=='' && digitsFinal[i]!==' ' && v!==digitsFinal[i] ? 'bg-red-50 border-red-300' : ''}`} value={v} disabled={digitsFinal[i]===' '} onChange={e => {setInputs2(p=>{const n=[...p];n[i]=e.target.value.slice(-1);return n;}); setErrorMsg('');}} />)}
                    </div>
                    {errorMsg && <div className="mt-3 text-center text-rose-500 font-bold text-sm bg-rose-50 p-2 rounded">{errorMsg}</div>}
                    <button onClick={checkAnswer} className="mt-5 w-full bg-indigo-600 text-white py-3 rounded-xl font-black shadow-md active:scale-95 transition-all hover:bg-indigo-700">æª¢æŸ¥å…¨å¼</button>
                </div>
            );
        };

        const VerticalMulti = ({ n1, n2, onComplete }) => {
            const digits1 = n1.toString().padStart(3, ' ').split('');
            const [inputs, setInputs] = useState(['', '', '', '']); const [carries, setCarries] = useState(['', '', '']);
            const [userOp, setUserOp] = useState('?');
            const [errorMsg, setErrorMsg] = useState('');
            const correctAns = n1 * n2;
            const correctDigits = correctAns.toString().padStart(4, ' ').split('');

            const checkAnswer = () => {
                if (userOp !== 'Ã—') { setErrorMsg('è«‹é¸æ“‡æ­£ç¢ºçš„è¨ˆç®—ç¬¦è™Ÿï¼(æ‡‰è©²æ˜¯ä¹˜æ³•å–”)'); return; }
                let userNumStr = inputs.map(d => d === '' ? ' ' : d).join('');
                if (parseInt(userNumStr.replace(/\s/g, '')) === correctAns) onComplete(correctAns);
                else setErrorMsg('ä¹˜æ³•ç®—éŒ¯å›‰ï¼è¨˜å¾—åŠ é€²ä½ã€‚');
            };

            return (
                <div className="bg-white p-6 rounded-2xl border-2 border-slate-200 shadow-sm max-w-sm mx-auto animate-in zoom-in-95">
                    <div className="grid grid-cols-5 gap-2 font-mono">
                        <div className="col-span-2"></div>{carries.map((v, i) => <input key={`c-${i}`} className="carry-input" placeholder="é€²" value={v} onChange={e=>setCarries(p=>{const n=[...p];n[i]=e.target.value.slice(-1);return n;})} />)}
                        <div className="col-span-2"></div>{digits1.map((d, i) => <div key={`d1-${i}`} className="h-10 flex items-center justify-center text-3xl font-black text-slate-700">{d}</div>)}
                        
                        <select value={userOp} onChange={e=>{setUserOp(e.target.value); setErrorMsg('');}} className="op-select col-span-1 text-3xl font-black text-blue-600 bg-blue-50 border-2 border-blue-200 rounded-lg">
                            <option value="?">?</option><option value="+">+</option><option value="-">-</option><option value="Ã—">Ã—</option>
                        </select>
                        <div className="col-span-3"></div>
                        <div className="col-span-1 h-10 flex items-center justify-center text-3xl font-black text-slate-700">{n2}</div>
                        
                        <div className="col-span-5 calc-line"></div>
                        <div className="col-span-1"></div>{inputs.map((v, i) => <input key={`in-${i}`} type="number" className={`digit-input h-14 ${v!=='' && correctDigits[i]!==' ' && v!==correctDigits[i] ? 'bg-red-50 border-red-300 text-red-600' : ''}`} value={v} disabled={correctDigits[i]===' '} placeholder={correctDigits[i]===' '?'':'?'} onChange={e => {setInputs(p=>{const n=[...p];n[i]=e.target.value.slice(-1);return n;}); setErrorMsg('');}} />)}
                    </div>
                    {errorMsg && <div className="mt-3 text-center text-rose-500 font-bold text-sm bg-rose-50 p-2 rounded">{errorMsg}</div>}
                    <button onClick={checkAnswer} className="mt-5 w-full bg-indigo-600 text-white py-3 rounded-xl font-black shadow-md active:scale-95 transition-all hover:bg-indigo-700">æª¢æŸ¥ç­”æ¡ˆ</button>
                </div>
            );
        };

        const ClockFace = ({ h, m, interactive, onTimeChange, onConfirm }) => {
            const hourAngle = (h * 30) + (m * 0.5);
            const minuteAngle = m * 6;
            const handleHour = () => interactive && onTimeChange(h===12?1:h+1, m);
            const handleMin = () => interactive && onTimeChange(h, m===0?30:0);

            return (
                <div className="flex flex-col items-center">
                    <svg width="180" height="180" viewBox="0 0 200 200" className="drop-shadow-lg my-4 bg-white rounded-full">
                        <circle cx="100" cy="100" r="95" fill="white" stroke="#334155" strokeWidth="6" />
                        {[...Array(12)].map((_, i) => <text key={i} x={100+75*Math.sin((i+1)*Math.PI/6)} y={105-75*Math.cos((i+1)*Math.PI/6)} textAnchor="middle" className="font-bold text-lg font-mono" fill="#64748b">{i+1}</text>)}
                        <line x1="100" y1="100" x2={100+50*Math.sin(hourAngle*Math.PI/180)} y2={100-50*Math.cos(hourAngle*Math.PI/180)} stroke="#1e293b" strokeWidth="6" strokeLinecap="round" />
                        <line x1="100" y1="100" x2={100+75*Math.sin(minuteAngle*Math.PI/180)} y2={100-75*Math.cos(minuteAngle*Math.PI/180)} stroke="#ef4444" strokeWidth="4" strokeLinecap="round" />
                        <circle cx="100" cy="100" r="5" fill="#1e293b" />
                    </svg>
                    {interactive && (
                        <div className="flex flex-col w-full gap-3">
                            <div className="flex gap-2 justify-center">
                                <button onClick={handleHour} className="px-4 py-2 bg-slate-200 text-slate-800 rounded-lg font-bold shadow hover:bg-slate-300 active:scale-95">èª¿æ™‚é‡</button>
                                <button onClick={handleMin} className="px-4 py-2 bg-slate-200 text-slate-800 rounded-lg font-bold shadow hover:bg-slate-300 active:scale-95">èª¿åˆ†é‡</button>
                            </div>
                            <button onClick={onConfirm} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-black shadow-md active:scale-95 transition-all hover:bg-indigo-700">ç¢ºèªæ™‚é–“</button>
                        </div>
                    )}
                </div>
            );
        };

        // --- æ ¸å¿ƒåŠŸèƒ½ï¼šå…¨çœŸé¡Œåº«ç”Ÿæˆå™¨ ---
        const generateQuizData = () => {
            const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
            const shuffle = (arr) => arr.sort(() => Math.random() - 0.5);

            const allQs = [
                // Q1: æ•¸å­—è®€æ³• (Past Paper Q1)
                (() => { 
                    const numMap = [{n: 52047, c: 'äº”è¬äºŒåƒé›¶å››åä¸ƒ'}, {n: 30205, c: 'ä¸‰è¬é›¶äºŒç™¾é›¶äº”'}, {n: 80016, c: 'å…«è¬é›¶ä¸€åå…­'}, {n: 12003, c: 'ä¸€è¬äºŒåƒé›¶ä¸‰'}, {n: 40500, c: 'å››è¬é›¶äº”ç™¾'}];
                    const pair = numMap[rand(0, numMap.length - 1)];
                    return { id: 1, title: 'æ•¸å­—è®€æ³•', text: `ã€Œ${pair.n}ã€è®€ä½œä»€éº¼ï¼Ÿ`, steps: [{ type: 'TEXT_INPUT', label: 'è«‹ç”¨ä¸­æ–‡å­—å¯«å‡ºè®€æ³•', correct: pair.c, hint: 'æ³¨æ„ã€Œé›¶ã€çš„å¯«æ³•ï¼Œä¸è¦æ‰“éŒ¯å­—å–”ï¼' }] }; 
                })(),
                
                // Q2: æ•¸å­—æ’åˆ— (Past Paper Q2)
                (() => {
                    const base = rand(3, 8);
                    const n1 = base * 10000 + 3003; // e.g. 33003
                    const n2 = base * 10000 + 303;  // e.g. 30303
                    const n3 = base * 10000 + 33;   // e.g. 30033
                    const sorted = [n3, n2, n1];
                    return { id: 2, title: 'æ•¸å­—æ’åˆ—', text: `è«‹æŠŠå„æ•¸ç”±å°è‡³å¤§æ’åˆ—å‡ºä¾†ï¼š\n${n1} ã€ ${n2} ã€ ${n3}`, steps: [
                        { type: 'INPUT_CHECK', label: 'æœ€å°çš„æ•¸ (ç¬¬ä¸€æ ¼)', correct: sorted[0].toString(), hint: 'å…ˆæ¯”è¼ƒåƒä½æ•¸å­—ï¼Œè¶Šå°è¶Šæ’å‰é¢' },
                        { type: 'INPUT_CHECK', label: 'ä¸­é–“çš„æ•¸ (ç¬¬äºŒæ ¼)', correct: sorted[1].toString(), hint: 'å†æ¯”è¼ƒç™¾ä½æ•¸å­—' },
                        { type: 'INPUT_CHECK', label: 'æœ€å¤§çš„æ•¸ (ç¬¬ä¸‰æ ¼)', correct: sorted[2].toString(), hint: 'å‰©ä¸‹é‚£å€‹å°±æ˜¯æœ€å¤§çš„' }
                    ]};
                })(),

                // Q3: ç®—æŸ±å¥‡æ•¸ (Past Paper Q3 è®Šé«”)
                { id: 3, title: 'ç®—æŸ±èˆ‡å¥‡æ•¸', text: `ç”¨ 3 ç²’ç®—ç åœ¨ç®—æŸ±ä¸Šè¡¨ç¤ºã€Œæœ€å°çš„äº”ä½å¥‡æ•¸ã€ã€‚`, steps: [
                    { type: 'LOGIC', text: 'äº”ä½æ•¸çš„è¬ä½æœ€å°‘è¦æ”¾å¹¾å¤šç²’ç ï¼Ÿ', options: shuffle(['1ç²’', '2ç²’', '3ç²’', '0ç²’']), ans: '1ç²’' },
                    { type: 'LOGIC', text: 'è¦æˆç‚ºã€Œå¥‡æ•¸ã€ï¼Œå€‹ä½æœ€å°‘è¦æ”¾å¹¾å¤šç²’ç ï¼Ÿ', options: shuffle(['1ç²’', '2ç²’', '3ç²’', '0ç²’']), ans: '1ç²’' },
                    { type: 'INPUT_CHECK', label: 'ç”¨ 3 ç²’ç ç Œå‡ºæœ€å°äº”ä½å¥‡æ•¸ï¼Œé€™å€‹æ•¸æ˜¯ï¼Ÿ', correct: '10011', hint: 'è¬ä½æ”¾1ç²’ï¼Œå€‹ä½æ”¾1ç²’ï¼Œå‰©ä¸‹1ç²’æ”¾å“ªè£¡æœ€å°ï¼Ÿ' }
                ]},

                // Q4: å››ä½æ•¸æ¸›æ³• (Past Paper Q4)
                (() => { const a=rand(6000,9000), b=rand(1000,5000); return { id: 4, title: 'å››ä½æ•¸æ¸›æ³•', text: `${a} - ${b} = ?`, steps: [{ type: 'LOGIC', text: 'é€™æ˜¯ä¸€æ¢ç´”æ¸›æ³•ã€‚', options: shuffle(['é–‹å§‹è¨ˆç®—', 'å¿ƒç®—', 'æ”¾æ£„', 'è·³é']), ans: 'é–‹å§‹è¨ˆç®—' }, { type: 'SUB', n1: a, n2: b, hint: 'å°å¿ƒå€Ÿä½' }]}; })(),
                
                // Q5: å››ä½æ•¸åŠ æ³• (Past Paper Q5)
                (() => { const a=rand(1000,4000), b=rand(2000,5000); return { id: 5, title: 'å››ä½æ•¸åŠ æ³•', text: `${a} + ${b} = ?`, steps: [{ type: 'LOGIC', text: 'é€™æ˜¯ä¸€æ¢ç´”åŠ æ³•ã€‚', options: shuffle(['é–‹å§‹è¨ˆç®—', 'å¿ƒç®—', 'æ”¾æ£„', 'è·³é']), ans: 'é–‹å§‹è¨ˆç®—' }, { type: 'ADD', n1: a, n2: b, hint: 'è¦å°å¿ƒé€£çºŒé€²ä½' }]}; })(),
                
                // Q6: è²¨å¹£æ‹¬è™Ÿé¡Œ (Past Paper Q6)
                (() => { const dA=rand(20,50), dB=rand(2,8), cB=rand(1,9), dC=rand(10,20), cC=rand(1,9); 
                    const v1 = dB*10 + cB; const v2 = dC*10 + cC; const total = dA*100; const ans = total - (v1+v2);
                    return { id: 6, title: 'è²¨å¹£èˆ‡æ‹¬è™Ÿ', text: `${dA}å…ƒ - (${dB}å…ƒ${cB}è§’ + ${dC}å…ƒ${cC}è§’) = ?`, steps: [
                    { type: 'LOGIC', text: 'æœ‰æ‹¬å¼§ï¼Œç¬¬ä¸€æ­¥å…ˆç®—æ‹¬å¼§å…§ã€‚æˆ‘å€‘çµ±ä¸€è½‰æˆã€Œè§’ã€ä¾†ç®—ã€‚', options: shuffle([`${v1} + ${v2} (è§’)`, `${total} - ${v1} (è§’)`]), ans: `${v1} + ${v2} (è§’)` }, 
                    { type: 'ADD', n1: v1, n2: v2, hint: 'ç”¨ç›´å¼è¨ˆç®—ç¸½èŠ±è²»(è§’)' }, 
                    { type: 'SUB', n1: total, n2: v1+v2, hint: `ç”¨ ${total} è§’æ¸›å»å‰›æ‰çš„ç­”æ¡ˆ` },
                    { type: 'INPUT_CHECK', label: `ç­”æ¡ˆæ˜¯ ${ans} è§’ï¼Œå³æ˜¯å¤šå°‘å…ƒå¤šå°‘è§’ï¼Ÿ(ä¾‹å¦‚ 12å…ƒ3è§’)`, correct: `${Math.floor(ans/10)}å…ƒ${ans%10}è§’`, hint: '10è§’ = 1å…ƒ' }
                ]}; })(),

                // Q7: é€£ä¹˜å·§ç®— (Past Paper Q7)
                (() => { const b=rand(3,9); return { id: 7, title: 'é€£ä¹˜æ³•å·§ç®—', text: `20 Ã— ${b} Ã— 5 = ?`, steps: [
                    { type: 'LOGIC', text: 'å·§ç®—ï¼šå…ˆç®—å“ªå…©å€‹æ•¸ç›¸ä¹˜æœƒå¾—å‡ºæ•´æ•¸ (ä¾‹å¦‚ 100)ï¼Ÿ', options: shuffle([`20 Ã— 5`, `20 Ã— ${b}`, `${b} Ã— 5`]), ans: `20 Ã— 5` }, 
                    { type: 'INPUT_CHECK', label: `20 Ã— 5 = ?`, correct: '100', hint: 'å¿ƒç®—' }, 
                    { type: 'INPUT_CHECK', label: `æœ€å¾Œç­”æ¡ˆï¼š100 Ã— ${b} = ?`, correct: (100*b).toString(), hint: 'å¿ƒç®—' }
                ]}; })(),

                // Q8: é€†å‘ä»£æ•¸ (Past Paper Q8)
                (() => { const a=4037, b=3219, target=2717; return { id: 8, title: 'é€†å‘æ€ç¶­', text: `${a} + ${b} - ğŸ˜Š = ${target}ã€‚ğŸ˜Š æ˜¯å¤šå°‘ï¼Ÿ`, steps: [
                    { type: 'LOGIC', text: 'Step 1: å…ˆæŠŠå‰é¢å¯ä»¥åŠ çš„æ•¸å­—åŠ èµ·ä¾†ã€‚', options: shuffle([`${a} + ${b}`, `${a} - ${target}`]), ans: `${a} + ${b}` }, 
                    { type: 'ADD', n1: a, n2: b, hint: 'ç”¨ç›´å¼å…ˆç®—åŠ æ³•' }, 
                    { type: 'LOGIC', text: `Step 2: ${a+b} - ğŸ˜Š = ${target}ã€‚è¦æ‰¾å‡º ğŸ˜Šï¼Œç®—å¼æ˜¯ï¼Ÿ`, options: shuffle([`${a+b} - ${target}`, `${a+b} + ${target}`]), ans: `${a+b} - ${target}` },
                    { type: 'SUB', n1: a+b, n2: target, hint: 'ç”¨ç›´å¼æ‰¾å‡º ğŸ˜Š' }
                ]}; })(),

                // Q9: é€£åŠ æ–‡å­—é¡Œ (Past Paper Q9)
                (() => { const a=rand(1000,1200), b=rand(3000,3200), c=rand(1400,1600); return { id: 9, title: 'ä¸‰æ•¸é€£åŠ ', text: `åœ–æ›¸é¤¨ç¬¬ä¸€å±¤æœ‰ ${a} æœ¬ï¼Œç¬¬äºŒå±¤ ${b} æœ¬ï¼Œç¬¬ä¸‰å±¤ ${c} æœ¬ã€‚å…±æœ‰å¤šå°‘æœ¬ï¼Ÿ`, steps: [
                    { type: 'LOGIC', text: 'æ±‚ç¸½æ•¸ï¼Œå°‡ä¸‰å±¤çš„æ›¸æœ¬ç›¸åŠ ã€‚', options: shuffle(['é–‹å§‹é€£å¼è¨ˆç®—', 'åˆ†é–‹ç®—', 'ä¹˜æ³•']), ans: 'é–‹å§‹é€£å¼è¨ˆç®—' }, 
                    { type: 'CONTINUOUS', n1: a, n2: b, n3: c, op1: '+', op2: '+', hint: 'è«‹ç”¨é€£åŠ ç›´å¼è¨ˆç®—' }
                ]}; })(),

                // Q10: ä¹˜æ¸›æ··åˆæ‰¾è´– (Past Paper Q10)
                (() => { const price=rand(2000,2400), pay=5000; return { id: 10, title: 'æ‰¾è´–å•é¡Œ', text: `é™³å…ˆç”Ÿè²·äº† 2 éƒ¨å¸å¡µæ©Ÿï¼Œæ¯éƒ¨ $${price}ã€‚ä»–ä»˜ $${pay}ï¼Œæ‡‰æ‰¾å›å¤šå°‘å…ƒï¼Ÿ`, steps: [
                    { type: 'LOGIC', text: 'Step 1: å…ˆç®— 2 éƒ¨å¸å¡µæ©Ÿçš„ç¸½åƒ¹', options: shuffle([`${price} Ã— 2`, `${pay} - ${price}`]), ans: `${price} Ã— 2` }, 
                    { type: 'MULTI', n1: price, n2: 2, hint: 'ç›´å¼è¨ˆç®—ç¸½åƒ¹' }, 
                    { type: 'LOGIC', text: `Step 2: ç”¨ $${pay} æ¸›å»ç¸½åƒ¹ ${price*2}`, options: shuffle([`${pay} - ${price*2}`, `${price*2} - ${pay}`]), ans: `${pay} - ${price*2}` },
                    { type: 'SUB', n1: pay, n2: price*2, hint: 'ç›´å¼è¨ˆç®—æ‰¾è´– (å°å¿ƒå€Ÿä½)' }
                ]}; })(),

                // Q11: é€£æ¸› (Past Paper Q11)
                (() => { const a=rand(1300,1500), b=rand(400,500), c=rand(40,60); return { id: 11, title: 'é€£æ¸›æ³•', text: `${a} - ${b} - ${c} = ?`, steps: [
                    { type: 'LOGIC', text: 'ç´”é€£æ¸›æ³•ã€‚', options: shuffle(['é–‹å§‹é€£å¼è¨ˆç®—', 'åˆ†é–‹ç®—']), ans: 'é–‹å§‹é€£å¼è¨ˆç®—' }, 
                    { type: 'CONTINUOUS', n1: a, n2: b, n3: c, op1: '-', op2: '-', hint: 'è«‹ç”¨é€£æ¸›ç›´å¼è¨ˆç®—' }
                ]}; })(),

                // Q12: æ‹¬è™Ÿæ¸›æ³• (Past Paper Q12)
                (() => { const a=rand(600,800), b=rand(200,300), c=rand(80,150); return { id: 12, title: 'æ‹¬è™Ÿæ¸›æ³•', text: `${a} - (${b} + ${c}) = ?`, steps: [
                    { type: 'LOGIC', text: 'æœ‰æ‹¬å¼§ï¼Œç¬¬ä¸€æ­¥å…ˆç®—ï¼Ÿ', options: shuffle([`${b} + ${c}`, `${a} - ${b}`]), ans: `${b} + ${c}` }, 
                    { type: 'ADD', n1: b, n2: c, hint: 'ç›´å¼è¨ˆç®—æ‹¬å¼§å…§' }, 
                    { type: 'SUB', n1: a, n2: b+c, hint: 'æœ€å¾Œè¨ˆç®—æ¸›æ³•' }
                ]}; })(),

                // Q13: é€£çºŒé™¤æ³• (Past Paper Q13)
                (() => { const a=200, b=8, c=5; return { id: 13, title: 'é€£çºŒé™¤æ³•', text: `${a} Ã· ${b} Ã· ${c} = ?`, steps: [
                    { type: 'LOGIC', text: 'å¾å·¦åˆ°å³ç®—ï¼Œç¬¬ä¸€æ­¥å…ˆç®—ä»€éº¼ï¼Ÿ', options: shuffle([`${a} Ã· ${b}`, `${b} Ã· ${c}`]), ans: `${a} Ã· ${b}` }, 
                    { type: 'INPUT_CHECK', label: `${a} Ã· ${b} = ?`, correct: (a/b).toString(), hint: 'å¿ƒç®—' }, 
                    { type: 'INPUT_CHECK', label: `å†é™¤ä»¥ ${c}ï¼Œç­”æ¡ˆæ˜¯ï¼Ÿ`, correct: ((a/b)/c).toString(), hint: 'å¿ƒç®—' }
                ]}; })(),

                // Q14: é™¤æ³•ä¼°ç®— (Past Paper Q14)
                (() => { const q=rand(40,49), d=6; const maxRem = d-1; const maxA = q*d + maxRem; const hDigit = Math.floor(maxA/100); return { id: 14, title: 'é™¤æ³•èˆ‡é¤˜æ•¸', text: `ã€Œ âœ¡ï¸ Ã· ${d} = ${q} ... ğŸ˜Š ã€ã€‚âœ¡ï¸ æ˜¯ä¸€å€‹ä¸‰ä½æ•¸ï¼Œå®ƒçš„ç™¾ä½æ•¸å­—æœ€å¤§å¯èƒ½æ˜¯å¤šå°‘ï¼Ÿ`, steps: [
                    { type: 'LOGIC', text: 'Step 1: è¢«é™¤æ•¸ = å•† Ã— é™¤æ•¸ + é¤˜æ•¸ã€‚å…ˆç®— å•† Ã— é™¤æ•¸', options: shuffle([`${q} Ã— ${d}`, `${q} + ${d}`]), ans: `${q} Ã— ${d}` }, 
                    { type: 'MULTI', n1: q, n2: d, hint: 'ç›´å¼è¨ˆç®—' }, 
                    { type: 'LOGIC', text: `é™¤æ•¸æ˜¯ ${d}ï¼Œé¤˜æ•¸ ğŸ˜Š æœ€å¤§åªèƒ½æ˜¯å¹¾å¤šï¼Ÿ`, options: shuffle([`${maxRem}`, `${d}`, `${d+1}`]), ans: `${maxRem}` },
                    { type: 'INPUT_CHECK', label: `æ‰€ä»¥ âœ¡ï¸ æœ€å¤§æ˜¯ ${q*d} + ${maxRem} = ?`, correct: maxA.toString(), hint: 'åŠ èµ·ä¾†' },
                    { type: 'INPUT_CHECK', label: `é€™å€‹æ•¸çš„ç™¾ä½æ•¸å­—æ˜¯ï¼Ÿ`, correct: hDigit.toString(), hint: 'çœ‹æœ€å·¦é‚Šçš„æ•¸å­—' }
                ]}; })(),

                // Q15: æœ‰é¤˜æ•¸é™¤æ³• (Past Paper Q15)
                (() => { const a=613, b=3; return { id: 15, title: 'é™¤æ³•è¨ˆç®—', text: `${a} Ã· ${b} = ?`, steps: [
                    { type: 'LOGIC', text: `æ€è€ƒï¼š600 Ã· 3 = 200ã€‚å‰©ä¸‹çš„ 13 Ã· 3 = ?`, options: shuffle(['4 ... 1', '4', '3 ... 4']), ans: '4 ... 1' }, 
                    { type: 'INPUT_CHECK', label: 'çµ„åˆèµ·ä¾†ï¼Œç­”æ¡ˆæ˜¯ï¼Ÿ(è¼¸å…¥æ ¼å¼å¦‚ 204...1)', correct: '204...1', hint: 'ä¸­é–“ç”¨ä¸‰å€‹é»é»é€£æ¥' }
                ]}; })(),

                // Q16: å–®ä½è½‰æ›èˆ‡é™¤æ³• (Past Paper Q16)
                { id: 16, title: 'å–®ä½æ›ç®—èˆ‡é™¤æ³•', text: 'å°æ˜æŠŠé•· 2 ç±³çš„çµ²å¸¶ï¼Œå¹³å‡åˆ†æˆ 4 æ®µï¼Œæ¯æ®µé•·å¹¾å¤šå˜ç±³ï¼Ÿ', steps: [
                    { type: 'LOGIC', text: 'é¡Œç›®å•ã€Œå˜ç±³ã€ï¼Œä½†é•·åº¦æ˜¯ã€Œç±³ã€ã€‚å…ˆæ›ç®—ï¼š2 ç±³ = ? å˜ç±³', options: shuffle(['200 å˜ç±³', '20 å˜ç±³', '2000 å˜ç±³']), ans: '200 å˜ç±³' }, 
                    { type: 'INPUT_CHECK', label: 'å¹³å‡åˆ†æˆ 4 æ®µï¼Œå³ 200 Ã· 4 = ?', correct: '50', hint: 'å¿ƒç®— 20 Ã· 4 å†åŠ  0' }
                ]},

                // Q17: æ—¥æœŸè¨ˆç®— (Past Paper Q17)
                (() => { const pay=rand(900,950); return { id: 17, title: 'æ—¥æœŸèˆ‡ä¹˜æ³•', text: `ç‹å”å”å·¥ä½œä¸€å¤©è³º $${pay}ï¼Œä»–åœ¨ä¸€æœˆåäº”æ—¥è‡³åä¸ƒæ—¥å·¥ä½œï¼Œå…±å¯è³ºå¹¾å¤šï¼Ÿ`, steps: [
                    { type: 'LOGIC', text: 'ã€Œåäº”æ—¥è‡³åä¸ƒæ—¥ã€ç¸½å…±æœ‰å¹¾å¤©ï¼Ÿ', options: shuffle(['3å¤©', '2å¤©', '4å¤©']), ans: '3å¤©' }, 
                    { type: 'MULTI', n1: pay, n2: 3, hint: 'ç›´å¼è¨ˆç®—ç¸½å·¥è³‡' }
                ]}; })(),

                // Q26: å€’æ°´é‡æ¯ (Past Paper Q26)
                (() => { const v1=500, v2=rand(200,400); return { id: 18, title: 'å®¹å™¨ç¸½å®¹é‡', text: 'æŠŠå®¹å™¨ Q å€’æ»¿å…©å€‹é‡æ¯ã€‚', isMultiBeaker: true, beakers: [{cap:500, lvl:v1, label:'é‡æ¯1'}, {cap:500, lvl:v2, label:'é‡æ¯2'}], steps: [
                    {type:'ADD', n1:v1, n2:v2, hint: 'ç›´å¼æŠŠå…©å€‹é‡æ¯çš„æ°´é‡åŠ èµ·ä¾†'}
                ]}; })(),

                // Q28: å®¹é‡ä»£å…¥æ³• (Past Paper Q28)
                { id: 19, title: 'å®¹é‡ä»£å…¥æ³•', text: 'è§€å¯Ÿåœ–ä¸­å®¹é‡é—œä¿‚ã€‚', isCapacitySub: true, steps: [
                    {type:'LOGIC', text: 'Step 1: æ—¢ç„¶ 1 ç…² = 2 ç“¶ + 2 æ¯ï¼Œè€Œ 1 æ°´å£º = 1 ç“¶ + 1 æ¯...', options: shuffle(['2 æ°´å£º = 2 ç“¶ + 2 æ¯', '1 æ°´å£º = 2 ç“¶ + 2 æ¯', '2 æ°´å£º = 1 ç“¶ + 1 æ¯']), ans: '2 æ°´å£º = 2 ç“¶ + 2 æ¯'},
                    {type:'LOGIC', text: 'Step 2: æ‰€ä»¥ 1 ç…²å‰›å¥½æ³¨æ»¿å¤šå°‘å€‹æ°´å£ºï¼Ÿ', options: shuffle(['2 å€‹', '1 å€‹', '3 å€‹', '4 å€‹']), ans: '2 å€‹'}
                ]},

                // Q29: é‡æ¯æ¯”è¼ƒ (Past Paper Q29)
                { id: 20, title: 'é‡æ¯æ¯”è¼ƒ', text: 'é‡æ¯ A(500mL)æ»¿æ°´ï¼›é‡æ¯ B(2L)åº•æœ‰ä¸€é»æ°´ï¼›é‡æ¯ C(1L)åŠæ»¿æ°´ã€‚', steps: [
                    {type:'LOGIC', text: 'é‡æ¯ C (1L) åŠæ»¿ï¼Œå³æ˜¯å¤šå°‘æ°´ï¼Ÿ', options: shuffle(['500 mL', '1000 mL', '250 mL', '100 mL']), ans: '500 mL'},
                    {type:'LOGIC', text: 'æ‰€ä»¥å“ªä¸€é …æè¿°æ­£ç¢ºï¼Ÿ', options: shuffle(['é‡æ¯ A å’Œ C çš„æ°´ä¸€æ¨£å¤š', 'é‡æ¯ A çš„æ°´æœ€å¤š', 'é‡æ¯ B å’Œ C çš„æ°´ä¸€æ¨£å¤š']), ans: 'é‡æ¯ A å’Œ C çš„æ°´ä¸€æ¨£å¤š'}
                ]},

                // Q33 & Q34: å¹¾ä½•ç‰¹æ€§ (Past Paper Q33, Q34)
                { id: 21, title: 'å¹¾ä½•åœ–å½¢ç‰¹æ€§', text: 'ä»¥ä¸‹å“ªé …æè¿°æ˜¯æ­£ç¢ºçš„ï¼Ÿ', steps: [
                    { type: 'LOGIC', text: 'æ‰€æœ‰å¹³è¡Œå››é‚Šå½¢éƒ½æœ‰ç”šéº¼ç‰¹æ€§ï¼Ÿ', options: shuffle(['å°é‚Šé•·åº¦ç›¸ç­‰', 'å››é‚Šé•·åº¦éƒ½ç›¸ç­‰', 'éƒ½æ˜¯æ­£æ–¹å½¢', 'æœ‰ 3 å€‹ç›´è§’']), ans: 'å°é‚Šé•·åº¦ç›¸ç­‰' },
                    { type: 'LOGIC', text: 'æ¢¯å½¢æœ‰ç”šéº¼ç¨ç‰¹çš„ç‰¹å¾µï¼Ÿ', options: shuffle(['åªæœ‰ä¸€çµ„å°é‚Šå¹³è¡Œ', 'æ‰€æœ‰æ¢¯å½¢éƒ½æ²’æœ‰ç›´è§’', 'æœ‰ä¸€å°é•·åº¦ç›¸ç­‰çš„å°é‚Š', 'éƒ½æ˜¯å¹³è¡Œå››é‚Šå½¢']), ans: 'åªæœ‰ä¸€çµ„å°é‚Šå¹³è¡Œ' }
                ]},

                // Q35: æ•¸å¹³è¡Œå››é‚Šå½¢ (Past Paper Q35)
                { id: 22, title: 'æ•¸å¹³è¡Œå››é‚Šå½¢', text: 'å³åœ–æ˜¯ä¸€å€‹å‘ˆã€Œç”°ã€å­—çš„æ–œå‘åœ–å½¢ã€‚', isGrid: true, steps: [
                    { type: 'LOGIC', text: 'åœ–ä¸­å…±æœ‰å¤šå°‘å€‹ã€Œæœ€å°ã€çš„å¹³è¡Œå››é‚Šå½¢ (1æ ¼)ï¼Ÿ', options: shuffle(['4 å€‹', '2 å€‹', '8 å€‹', '1 å€‹']), ans: '4 å€‹' },
                    { type: 'LOGIC', text: 'ç”± 2 å€‹å°æ ¼æ‹¼æˆçš„å¹³è¡Œå››é‚Šå½¢ (æ©«å‘2å€‹+ç›´å‘2å€‹) æœ‰å¹¾å€‹ï¼Ÿ', options: shuffle(['4 å€‹', '2 å€‹', '6 å€‹', '0 å€‹']), ans: '4 å€‹' },
                    { type: 'INPUT_CHECK', label: 'åŠ ä¸Šæœ€å¤§ç”±4æ ¼æ‹¼æˆçš„é‚£ 1 å€‹ï¼Œç¸½å…±å¯æ•¸å‡ºå¹¾å€‹ï¼Ÿ', correct: '9', hint: '4 + 4 + 1' }
                ]},

                // Q37: è±¡å½¢åœ–çµ‚æ¥µé‚„åŸ (Past Paper Q37)
                (() => {
                    const data = [{name:'æ¸¸æ³³ç­', value:6}, {name:'é›»è…¦ç­', value:4}, {name:'æ²¹ç•«ç­', value:8}, {name:'æ›¸æ³•ç­', value:1}, {name:'èˆè¹ˆç­', value:6}];
                    return { id: 23, title: 'è±¡å½¢åœ–ç¶œåˆåˆ†æ', text: 'é€™æ˜¯ 3E ç­å­¸ç”Ÿæœ€å–œæ­¡çš„èˆˆè¶£ç­çµ±è¨ˆã€‚', isPictogram: true, data: data, steps: [
                        {type:'INPUT_CHECK', label: '3E ç­å­¸ç”Ÿå…±æœ‰å¤šå°‘äººï¼Ÿ', correct: '25', hint: 'æŠŠå®ƒå€‘å…¨éƒ¨åŠ èµ·ä¾†'},
                        {type:'LOGIC', text: 'å“ªä¸€ç­åªæœ‰ä¸€ä½å­¸ç”Ÿé¸æ“‡ï¼Ÿ', options: shuffle(['æ›¸æ³•ç­', 'é›»è…¦ç­', 'æ¸¸æ³³ç­', 'èˆè¹ˆç­']), ans: 'æ›¸æ³•ç­'},
                        {type:'INPUT_CHECK', label: 'é¸æ“‡æ²¹ç•«ç­çš„äººæ•¸æ˜¯é›»è…¦ç­çš„å¹¾å¤šå€ï¼Ÿ', correct: '2', hint: 'æ²¹ç•«ç­ 8 äººï¼Œé›»è…¦ç­ 4 äºº'}
                    ]};
                })(),

                // çµ‚æ¥µä¸‰æ•¸æ¯”è¼ƒé¡Œ (çˆ¸çˆ¸åª½åª½è¡¨å§)
                (() => {
                    const dad=rand(2800,3200), mom=rand(2100,2400), diff=rand(150,250);
                    const cousin = mom + diff; const finalAns = dad - cousin;
                    return { id: 24, title: 'ä¸‰æ•¸æ¯”è¼ƒé¡Œ (çµ‚æ¥µæ‹†è§£)', text: `çˆ¸çˆ¸æœ‰ $${dad}ï¼Œåª½åª½æœ‰ $${mom}ã€‚åª½åª½æ¯”è¡¨å§å°‘ $${diff}ã€‚å•çˆ¸çˆ¸æ¯”è¡¨å§å¤šå¹¾å…ƒï¼Ÿ`, steps: [
                        {type:'LOGIC', text: 'Step 1: åª½åª½æ¯”è¡¨å§å°‘ï¼Œå³è¡¨å§è¼ƒå¤šã€‚ç¶œåˆç®—å¼æ˜¯ï¼Ÿ', options: shuffle([`${dad} - (${mom} + ${diff})`, `${dad} - ${mom} + ${diff}`, `(${dad} - ${mom}) - ${diff}`, `${dad} + ${mom} - ${diff}`]), ans: `${dad} - (${mom} + ${diff})`},
                        {type:'ADD', n1: mom, n2: diff, hint: 'Step 2: å…ˆè¨ˆç®—æ‹¬å¼§å…§çš„éƒ¨åˆ†ï¼ˆæ‰¾å‡ºè¡¨å§çš„éŒ¢ï¼‰'},
                        {type:'SUB', n1: dad, n2: cousin, hint: 'Step 3: ç”¨çˆ¸çˆ¸çš„éŒ¢æ¸›å»å‰›æ‰ç®—å‡ºçš„è¡¨å§çš„éŒ¢'},
                        {type:'INPUT_CHECK', label: 'Step 4: å¡«å¯«æ–‡å­—ç­”å¥ï¼šçˆ¸çˆ¸æ¯”è¡¨å§å¤š _____ å…ƒã€‚', correct: finalAns.toString(), hint: 'æŠŠå‰›æ‰ç›´å¼æœ€å¾Œçš„ç­”æ¡ˆå¡«å…¥å¥å­ä¸­'}
                    ]};
                })(),

                // å‚™ç”¨: å¤©å¹³é‚è¼¯
                { id: 25, title: 'å¤©å¹³é‚è¼¯', text: 'å·²çŸ¥ï¼š1å€‹ç½ = 2å€‹çƒã€‚å¦å¤–ï¼š1å€‹ç“œ = 1å€‹ç½ + 2å€‹çƒã€‚å•ï¼š1å€‹ç“œç­‰æ–¼å¤šå°‘å€‹çƒï¼Ÿ', steps: [{type:'LOGIC', text: 'æ—¢ç„¶ 1å€‹ç½ = 2å€‹çƒï¼Œæˆ‘å€‘å¯ä»¥æŠŠã€Œç“œã€æ—é‚Šçš„ã€Œç½ã€æ›æˆä»€éº¼ï¼Ÿ', options: shuffle(['2å€‹çƒ', '1å€‹çƒ', '3å€‹çƒ', 'ä¸è®Š']), ans: '2å€‹çƒ'}, {type:'LOGIC', text: 'ç¾åœ¨ç­‰å¼è®Šæˆã€Œ1å€‹ç“œ = 2å€‹çƒ + 2å€‹çƒã€ã€‚æ‰€ä»¥ï¼Ÿ', options: shuffle(['4å€‹çƒ', '3å€‹çƒ', '2å€‹çƒ', '5å€‹çƒ']), ans: '4å€‹çƒ'} ]}

            ];

            return shuffle(allQs);
        };

        const App = () => {
            const [mode, setMode] = useState('MENU');
            const [devMode, setDevMode] = useState(false);
            const [questions, setQuestions] = useState([]);
            const [qIndex, setQIndex] = useState(0);
            const [stepIndex, setStepIndex] = useState(0);
            const [mistakeList, setMistakeList] = useState([]); 
            const [timer, setTimer] = useState(0);
            const [clockState, setClockState] = useState({h: 12, m: 0});
            const [praise, setPraise] = useState('');
            const [showHint, setShowHint] = useState(false);
            const timerRef = useRef(null);

            const startQuiz = () => {
                setQuestions(generateQuizData());
                setQIndex(0); setStepIndex(0); setMistakeList([]); setTimer(0); setMode('GAME');
            };

            const jumpToQuestion = (targetId) => {
                const newQs = generateQuizData();
                const targetQIndex = newQs.findIndex(q => q.id === parseInt(targetId));
                if(targetQIndex > -1){
                    const targetQ = newQs.splice(targetQIndex, 1)[0];
                    newQs.unshift(targetQ); 
                }
                setQuestions(newQs);
                setQIndex(0); setStepIndex(0); setMistakeList([]); setTimer(0); setMode('GAME');
            }

            const currentQ = questions[qIndex] || {};
            const currentStep = currentQ.steps ? currentQ.steps[stepIndex] : {};
            const progress = questions.length > 0 ? ((qIndex) / questions.length) * 100 : 0;

            useEffect(() => {
                if (mode === 'GAME') {
                    timerRef.current = setInterval(() => setTimer(t => t + 1), 1000);
                } else clearInterval(timerRef.current);
                return () => clearInterval(timerRef.current);
            }, [mode]);

            useEffect(() => {
                if (mode === 'GAME' && currentStep.type === 'CLOCK_INTERACTIVE') {
                    setClockState({ h: currentStep.startH || 12, m: currentStep.startM || 0 });
                }
                setShowHint(false);
            }, [qIndex, stepIndex, mode, questions]);

            const showPraiseText = () => {
                setPraise(PRAISE_WORDS[Math.floor(Math.random() * PRAISE_WORDS.length)]);
                setTimeout(() => setPraise(''), 1500);
            };

            const markMistake = (detail) => {
                setMistakeList(prev => [...prev, { qId: currentQ.id, title: currentQ.title, correctText: currentQ.text, errorDetail: detail }]);
            };

            const handleLogicChoice = (opt) => {
                if (opt === currentStep.ans) { showPraiseText(); nextStep(); } 
                else { markMistake(`é‚è¼¯é¸éŒ¯ï¼šé¸äº† ${opt} (æ­£ç¢º: ${currentStep.ans})`); alert(`é¸éŒ¯äº†ï¼è©¦è©¦å…¶ä»–çš„ã€‚`); }
            };

            const handleCalcComplete = (val) => { showPraiseText(); nextStep(); };

            const handleInputCheck = (val) => {
                if (val.trim() === currentStep.correct) { showPraiseText(); nextStep(); } 
                else { markMistake(`å¡«å¯«éŒ¯èª¤ï¼šå¡«äº† ${val} (æ­£ç¢º: ${currentStep.correct})`); alert(`ç­”æ¡ˆä¸å°å–”ï¼`); }
            };
            
            const handleTextInputCheck = (val, correctAns) => {
                const normalizedVal = val.replace(/ã€‡/g, 'é›¶').replace(/\s+/g, '');
                const normalizedCorrect = correctAns.replace(/ã€‡/g, 'é›¶').replace(/\s+/g, '');

                if (normalizedVal === normalizedCorrect) {
                    showPraiseText();
                    nextStep();
                } else {
                    markMistake(`ä¸­æ–‡å­—å¯«éŒ¯ï¼šå¯«äº†ã€Œ${val}ã€ (æ­£ç¢º:ã€Œ${correctAns}ã€)`);
                    alert(`å¯«éŒ¯äº†å–”ï¼è«‹æª¢æŸ¥æœ‰æ²’æœ‰æ¼å­—æˆ–éŒ¯åˆ¥å­—ã€‚`);
                }
            };

            const handleTimeUpdate = (newH, newM) => setClockState({h: newH, m: newM});
            const handleClockConfirm = () => {
                let targetH = currentStep.targetH, h = clockState.h, m = clockState.m, isCorrect = false;
                if (m === currentStep.targetM) {
                    if (h === targetH || (h > 12 && h - 12 === targetH) || (targetH > 12 && h === targetH - 12)) isCorrect = true;
                }
                if (isCorrect) { showPraiseText(); nextStep(); } 
                else { markMistake(`æ™‚é–“èª¿éŒ¯ï¼šèª¿åˆ°äº† ${h}:${m}`); alert(`æ™‚é–“ä¸å°ï¼Œè«‹å†èª¿ä¸€æ¬¡ï¼`); }
            };

            const nextStep = () => {
                if (stepIndex < currentQ.steps.length - 1) setStepIndex(p => p + 1);
                else {
                    if (qIndex < questions.length - 1) { setQIndex(q => q + 1); setStepIndex(0); } 
                    else setMode('RESULT');
                }
            };
            
            const forceSkipQuestion = () => {
                if (qIndex < questions.length - 1) { setQIndex(q => q + 1); setStepIndex(0); setShowHint(false); } 
                else setMode('RESULT');
            }

            const renderHint = (hintText) => {
                if (!hintText) return null;
                return (
                    <div className="mb-4 text-center h-12 flex items-center justify-center">
                        {!showHint ? (
                            <button onClick={() => setShowHint(true)} className="flex items-center gap-2 bg-slate-100 text-slate-500 hover:bg-slate-200 hover:text-slate-700 px-5 py-2 rounded-full font-bold text-sm transition-all active:scale-95 shadow-sm">
                                <Icon.Idea /> é»æ“Šé¡¯ç¤ºæç¤º
                            </button>
                        ) : (
                            <div className="animate-in zoom-in-95 bg-yellow-50 border border-yellow-200 text-yellow-800 px-5 py-2 rounded-full font-bold text-sm flex items-center gap-2 shadow-sm">
                                <Icon.Idea /> æç¤ºï¼š{hintText}
                            </div>
                        )}
                    </div>
                );
            };

            const renderStep = () => {
                const stepKey = `${qIndex}-${stepIndex}`; 
                switch(currentStep.type) {
                    case 'LOGIC': return <div key={stepKey} className="grid gap-4 animate-in slide-in-from-right"><div className="bg-indigo-50 p-4 rounded-xl text-indigo-800 font-bold flex gap-2"><Icon.Brain/> {currentStep.text}</div>{currentStep.options.map((o, i) => <button key={i} onClick={() => handleLogicChoice(o)} className="p-4 border-2 border-slate-200 rounded-xl font-bold hover:bg-indigo-100 hover:border-indigo-400 text-left transition-colors">{o}</button>)}</div>;
                    case 'ADD': case 'SUB': return <div key={stepKey} className="animate-in zoom-in-95">{renderHint(currentStep.hint)}<VerticalAddSub n1={currentStep.n1} n2={currentStep.n2} op={currentStep.type==='ADD'?'+':'-'} onComplete={handleCalcComplete} /></div>;
                    case 'MULTI': return <div key={stepKey} className="animate-in zoom-in-95">{renderHint(currentStep.hint)}<VerticalMulti n1={currentStep.n1} n2={currentStep.n2} onComplete={handleCalcComplete} /></div>;
                    case 'CONTINUOUS': return <div key={stepKey} className="animate-in zoom-in-95">{renderHint(currentStep.hint)}<VerticalContinuous n1={currentStep.n1} n2={currentStep.n2} n3={currentStep.n3} op1={currentStep.op1} op2={currentStep.op2} onComplete={handleCalcComplete} /></div>;
                    case 'INPUT_CHECK': return <div key={stepKey} className="flex flex-col gap-4 animate-in slide-in-from-right"><label className="font-bold text-slate-700 text-center">{currentStep.label}</label>{renderHint(currentStep.hint)}<input type="text" className="p-4 border-2 border-slate-300 rounded-xl text-center text-2xl font-black focus:border-indigo-500 outline-none" placeholder="è¼¸å…¥æ•¸å­—ç­”æ¡ˆ" onKeyDown={(e)=>{if(e.key==='Enter') handleInputCheck(e.target.value)}} /><button className="bg-slate-800 text-white p-4 rounded-xl font-black active:scale-95 hover:bg-slate-700 transition-all" onClick={(e)=>handleInputCheck(e.target.previousSibling.value)}>ç¢ºå®š</button></div>;
                    case 'TEXT_INPUT': return <div key={stepKey} className="flex flex-col gap-4 animate-in slide-in-from-right"><label className="font-bold text-slate-700 text-center">{currentStep.label}</label>{renderHint(currentStep.hint)}<input type="text" className="p-4 border-2 border-slate-300 rounded-xl text-center text-2xl font-black focus:border-indigo-500 outline-none" placeholder="è¼¸å…¥ä¸­æ–‡å­—..." onKeyDown={(e)=>{if(e.key==='Enter') handleTextInputCheck(e.target.value, currentStep.correct)}} /><button className="bg-slate-800 text-white p-4 rounded-xl font-black active:scale-95 hover:bg-slate-700 transition-all" onClick={(e)=>handleTextInputCheck(e.target.previousSibling.value, currentStep.correct)}>ç¢ºå®š</button></div>;
                    case 'CLOCK_INTERACTIVE': return <div key={stepKey} className="animate-in zoom-in-95">{renderHint(currentStep.hint)}<ClockFace h={clockState.h} m={clockState.m} interactive={true} onTimeChange={handleTimeUpdate} onConfirm={handleClockConfirm}/></div>;
                    default: return null;
                }
            };

            if (mode === 'MENU') return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4">
                    <div className="bg-white rounded-[2.5rem] p-8 md:p-12 max-w-lg w-full shadow-2xl text-center border border-slate-100">
                        <div className="inline-block p-4 bg-indigo-100 rounded-full text-indigo-600 mb-6"><Icon.Brain/></div>
                        <h1 className="text-3xl font-black text-slate-800 mb-2">Jasper æ•¸å­¸ V9.1</h1>
                        <p className="text-indigo-500 font-bold mb-8 uppercase tracking-widest">çœŸé¡Œå°é½Šç‰ˆ (25é¡Œ)</p>
                        <div className="text-left bg-slate-50 p-6 rounded-2xl mb-8 space-y-3 text-slate-600 font-bold text-sm">
                            <p>ğŸ”¥ é›£åº¦å‡ç´šï¼Œå®Œå…¨å°é½ŠçœŸå¯¦è©¦å·</p>
                            <p>ğŸ§© æ–°å¢ï¼šæ’åºã€æ—¥æœŸã€é€†å‘ä»£æ•¸é¡Œ</p>
                            <p>ğŸ’¡ çµ‚æ¥µå››æ­¥æ‹†è§£è¤‡é›œæ–‡å­—é¡Œ</p>
                        </div>
                        <button onClick={startQuiz} className="w-full bg-indigo-600 text-white text-xl font-black py-5 rounded-2xl shadow-xl hover:bg-indigo-700 active:scale-95 transition-all">é–‹å§‹ç‰¹è¨“</button>
                    </div>
                    
                    {/* å®¶é•·æ¸¬è©¦é¢æ¿é–‹é—œ */}
                    <div className="mt-8 text-center">
                        <button onClick={() => setDevMode(!devMode)} className="text-xs text-slate-400 font-bold hover:text-slate-600 transition-all">
                            âš™ï¸ {devMode ? 'éš±è—' : 'é¡¯ç¤º'}å®¶é•·æ¸¬è©¦é¢æ¿
                        </button>
                        {devMode && (
                            <div className="mt-4 bg-white p-4 rounded-xl shadow border border-slate-200 max-w-lg mx-auto flex flex-wrap gap-2 justify-center animate-in zoom-in-95">
                                <div className="w-full text-xs font-bold text-slate-500 mb-2">é»æ“Šå³å¯ç›´æ¥æ¸¬è©¦è©²é¡Œå‹ï¼š</div>
                                <button onClick={() => jumpToQuestion(2)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">æ’åºé™·é˜± (Q2)</button>
                                <button onClick={() => jumpToQuestion(3)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">ç®—æŸ±å¥‡æ•¸ (Q3)</button>
                                <button onClick={() => jumpToQuestion(6)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">è²¨å¹£è§’åˆ†è½‰åŒ– (Q6)</button>
                                <button onClick={() => jumpToQuestion(8)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">é€†å‘ä»£æ•¸é¡Œ (Q8)</button>
                                <button onClick={() => jumpToQuestion(14)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">é™¤æ³•é¤˜æ•¸ä¼°ç®— (Q14)</button>
                                <button onClick={() => jumpToQuestion(17)} className="px-3 py-1 bg-slate-200 rounded text-xs font-bold hover:bg-slate-300">éš±è—æ—¥æœŸ (Q17)</button>
                            </div>
                        )}
                    </div>
                </div>
            );

            if (mode === 'RESULT') {
                const uniqueMistakes = mistakeList.filter((v,i,a)=>a.findIndex(t=>(t.qId===v.qId))===i);
                return (
                    <div className="min-h-screen flex items-center justify-center p-4">
                        <div className="bg-white rounded-[2.5rem] p-10 max-w-lg w-full shadow-2xl text-center border border-slate-100 animate-in zoom-in-95">
                            <h2 className="text-4xl font-black text-slate-800 mb-6">ç‰¹è¨“çµæŸï¼</h2>
                            {uniqueMistakes.length === 0 ? (
                                <div className="bg-green-50 p-8 rounded-3xl text-green-700 font-bold mb-8 border border-green-200">å¤ªæ£’äº†ï¼é€™æ¬¡å…¨å°ï¼</div>
                            ) : (
                                <div className="text-left bg-rose-50 p-6 rounded-3xl mb-8 border border-rose-100 max-h-60 overflow-y-auto custom-scrollbar">
                                    <h3 className="font-bold text-rose-600 mb-4">âš ï¸ éŒ¯èª¤å›é¡§ï¼š</h3>
                                    {uniqueMistakes.map((m, i) => (
                                        <div key={i} className="mb-4 border-b border-rose-200 pb-3 last:border-0">
                                            <div className="font-black text-slate-800">{m.title}</div>
                                            <div className="text-xs text-slate-500 mb-1">{m.correctText}</div>
                                            <div className="text-sm font-bold text-rose-500 bg-white px-2 py-1 rounded inline-block mt-1">{m.errorDetail}</div>
                                        </div>
                                    ))}
                                </div>
                            )}
                            <button onClick={startQuiz} className="w-full bg-slate-800 text-white text-xl font-black py-4 rounded-2xl shadow-xl active:scale-95 transition-all">å†ä¾†ä¸€æ¬¡ (æ–°é¡Œç›®)</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-2xl mx-auto relative overflow-hidden">
                    {praise && (
                        <div className="fixed top-12 left-1/2 z-50 pointer-events-none toast-anim">
                            <div className="bg-emerald-500 text-white px-8 py-3 rounded-full text-2xl font-black shadow-2xl border-4 border-white flex items-center gap-3">
                                <Icon.Check /> {praise}
                            </div>
                        </div>
                    )}
                    
                    <div className="flex justify-between items-center mb-6">
                        <div className="flex items-center gap-3 px-5 py-3 bg-white rounded-2xl font-bold text-slate-600 shadow-sm border border-slate-100"><span>Q {qIndex + 1} / {questions.length}</span></div>
                        <div className="flex items-center gap-2">
                            {devMode && (
                                <button onClick={forceSkipQuestion} className="flex items-center gap-1 px-3 py-2 bg-slate-800 text-white rounded-xl font-bold text-xs shadow-sm hover:bg-slate-700 active:scale-95 transition-all">
                                    <Icon.FastForward /> è·³é
                                </button>
                            )}
                            <div className="flex items-center gap-3 px-5 py-3 bg-white rounded-2xl font-bold text-indigo-600 shadow-sm border border-slate-100"><Icon.Clock/> <span>{Math.floor(timer/60)}:{timer%60 < 10 ? '0'+timer%60 : timer%60}</span></div>
                        </div>
                    </div>
                    
                    <div className="w-full bg-slate-200 h-2 rounded-full mb-6 overflow-hidden"><div className="bg-indigo-500 h-full transition-all duration-500" style={{width: `${progress}%`}}></div></div>
                    
                    <div className="bg-white rounded-[2.5rem] shadow-xl border border-slate-200 overflow-hidden relative">
                        <div className="bg-slate-50 p-8 border-b border-slate-100 text-center relative">
                            <div className="inline-block px-3 py-1 rounded-full bg-indigo-100 text-indigo-600 text-xs font-black uppercase tracking-widest mb-3">{currentQ.title}</div>
                            <h2 className="text-3xl font-black text-slate-800 leading-snug whitespace-pre-wrap">{currentQ.text}</h2>
                            
                            {currentQ.isBeaker && <BeakerView capacity={currentQ.cap} level={currentQ.lvl} label="é‡æ¯" />}
                            {currentQ.isMultiBeaker && <div className="flex justify-center flex-wrap">{currentQ.beakers.map((b,i)=><BeakerView key={i} capacity={b.cap} level={b.lvl} label={b.label} />)}</div>}
                            {currentQ.isAbacus && <AbacusView number={currentQ.val} />}
                            {currentQ.isPictogram && <PictogramView data={currentQ.data} title="3Eç­èˆˆè¶£ç­çµ±è¨ˆ
